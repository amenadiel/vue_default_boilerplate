<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>♻️ Transformations | 🔳 Edge Resizer</title>
    <meta name="description" content="Cache, transform and optimize image responses from your site">
    <link rel="stylesheet" href="/assets/style.d169f7b0.css">
    <link rel="modulepreload" href="/assets/Home.e64150d0.js">
    <link rel="modulepreload" href="/assets/app.9b700571.js">
    <link rel="modulepreload" href="/assets/transformations.md.7ec57a01.lean.js">
    <link rel="modulepreload" href="/assets/app.9b700571.js">
    <meta name="twitter:title" content="♻️ Transformations | 🔳 Edge Resizer">
    <meta property="og:title" content="♻️ Transformations | 🔳 Edge Resizer">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-675d8756><div class="sidebar-button" data-v-675d8756><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/" aria-label="🔳 Edge Resizer, back to home" data-v-675d8756 data-v-4a583abe><!----> 🔳 Edge Resizer</a><div class="flex-grow" data-v-675d8756></div><div class="nav" data-v-675d8756><nav class="nav-links" data-v-675d8756 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://images.weserv.nl/" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>Images.weserv.nl <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://developers.cloudflare.com/workers/" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>Cloudflare Workers <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><!--]--><!----><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://github.com/ctohm/edge-resizer" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav></div><!--[--><!--]--></header><aside class="sidebar" data-v-83e92a68><nav class="nav-links nav" data-v-83e92a68 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://images.weserv.nl/" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>Images.weserv.nl <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://developers.cloudflare.com/workers/" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>Cloudflare Workers <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><!--]--><!----><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://github.com/ctohm/edge-resizer" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav><!--[--><!--]--><ul class="sidebar-links" data-v-83e92a68><!--[--><li class="sidebar-link"><a class="sidebar-link-item" href="/about.html">🍬 About</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/routing.html">🔌 Routing Strategy</a><!----></li><li class="sidebar-link"><p class="sidebar-link-item">📡 Usage modes</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/hotlinking.html">🔗 Hotlink at will</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/deploy.html">🌎 Deploy your own</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/library.html">📙 Use it as a library</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/transformations.html">♻️ Transformations</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/conversion.html">🔃 Conversion</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/caching.html">🚀 Caching</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/use_cases.html">⛳ Use Cases</a><!----></li><!--]--></ul><!--[--><!--]--></aside><!-- TODO: make this button accessible --><div class="sidebar-mask"></div><main class="page" data-v-7eddb2c4><div class="container" data-v-7eddb2c4><!--[--><!--]--><div style="position:relative;" class="content" data-v-7eddb2c4><div><h1 id="♻️-transformations" tabindex="-1">♻️ Transformations <a class="header-anchor" href="#♻️-transformations" aria-hidden="true">#</a></h1><p>Our routing logic expects the transformation part to come right before the target image hostname. This part of the variation url will be translated -under the hood- to searchParams as expected by <a href="https://images.weserv.nl/" target="_blank" rel="noopener noreferrer">images.weserv.nl API</a>.</p><p>e.g resize to 150x150</p><div class="language-html"><pre><code>https://img.ctohm.com/w=150_h=150/riff.one/images/designcue-unsplash.jpg`
</code></pre></div><div style="display:flex;align-items:baseline;"><div style="flex:1;padding-right:1em;text-align:justify;"><!--[--> Except for the very first time they are requested (and inmediately cached), variations will answer from the edge at blazing speed, and will even survive for a few months if the original image is deleted. The image to the right doesn&#39;t exist but in Cloudflare&#39;s Cache. <!--]--><br><p><!--[-->The response headers will also hint the browser not to request this same asset for a year. While this isn&#39;t much of a feature, your browser will hopefully not need requesting it anytime soon and that will shave a couple of ms off. <!--]--></p></div><!--[--><table><thead><tr><th>w=150 h=150</th></tr></thead><tbody><tr><td><img src="https://img.ctohm.com/w=150_h=150/riff.one/images/designcue-unsplash.jpg" alt="150x150"></td></tr></tbody></table><!--]--></div><p>In this section we enumerate supported transformations such as resizing, optimizing, compression, changing format, cropping and changing hue. Other transformations can be passed directly as searchParams to the variation URL (not ideal, but 🤷)</p><hr><h2 id="available-transformations" tabindex="-1">Available Transformations <a class="header-anchor" href="#available-transformations" aria-hidden="true">#</a></h2><h3 id="width-and-height" tabindex="-1">Width and Height <a class="header-anchor" href="#width-and-height" aria-hidden="true">#</a></h3><ul><li>w: <a href="https://images.weserv.nl/docs/size.html#width" target="_blank" rel="noopener noreferrer">🔗 Width</a>,</li><li>h: <a href="https://images.weserv.nl/docs/size.html#height" target="_blank" rel="noopener noreferrer">🔗 Height</a></li><li>dpr: <a href="https://images.weserv.nl/docs/size.html#device-pixel-ratio" target="_blank" rel="noopener noreferrer">🔗 Device Pixel Ratio</a></li></ul><div class="language-html"><pre><code>https://img.ctohm.com/w=150_h=150/riff.one/images/dice.png
</code></pre></div><table><thead><tr><th>dpr=2 w=200 l=0</th><th>dpr=4 w=200</th><th>dpr=2 w=200</th><th>dpr=4 w=200</th></tr></thead><tbody><tr><td><img src="https://img.ctohm.com/dpr=2_w=200_png_l=0/riff.one/images/dice.png" alt="original"></td><td><img src="https://img.ctohm.com/dpr=4_w=200_png_l=6_af/riff.one/images/dice.png" alt="jpg"></td><td><img src="https://img.ctohm.com/dpr=2_w=200_jpg_q=100/riff.one/images/designcue-unsplash.jpg" alt="af"></td><td><img src="https://img.ctohm.com/dpr=2_w=200_jpg_q=5/riff.one/images/designcue-unsplash.jpg" alt="webp"></td></tr></tbody></table><h3 id="fit-colorize-sharpen" tabindex="-1">Fit/Colorize/Sharpen <a class="header-anchor" href="#fit-colorize-sharpen" aria-hidden="true">#</a></h3><ul><li>fit: <a href="https://images.weserv.nl/docs/fit.html" target="_blank" rel="noopener noreferrer">🔗 Fit</a> (contain, cover, inside, outside, fill)</li><li>bg: <a href="https://images.weserv.nl/docs/adjustment.html#background" target="_blank" rel="noopener noreferrer">🔗 Background Color</a> (eg fit=contain&amp;cbg=0f0)</li><li>cbg: Background Color for Fit=Contain (eg fit=contain&amp;cbg=0f0)</li><li>hue: <a href="https://images.weserv.nl/docs/adjustment.html#hue-rotation" target="_blank" rel="noopener noreferrer">🔗 Hue Rotation (0 to 360) </a></li><li>sharp: <a href="https://images.weserv.nl/docs/adjustment.html#sharpen" target="_blank" rel="noopener noreferrer">🔗 Sharpen</a></li><li>n: <a href="https://images.weserv.nl/docs/format.html#number-of-pages" target="_blank" rel="noopener noreferrer">Number of Pages</a> (is multipage images still a thing?)</li></ul><table><thead><tr><th>w=100 hue=160</th><th>w=160 h=100 cbg=green</th><th>w=150 h=100 fit=cover sharp=4</th></tr></thead><tbody><tr><td><img src="https://img.ctohm.com/w=100_hue=160/riff.one/images/designcue-unsplash.jpg" alt="original"></td><td><img src="https://img.ctohm.com/w=160_h=100_cbg=green/riff.one/images/designcue-unsplash.jpg" alt="fit and cbg"></td><td><img src="https://img.ctohm.com/w=150_h=100_fit=cover&amp;sharp=4/riff.one/images/designcue-unsplash.jpg" alt="fit and cbg"></td></tr></tbody></table><h3 id="compression-optimization" tabindex="-1">Compression/Optimization <a class="header-anchor" href="#compression-optimization" aria-hidden="true">#</a></h3><ul><li>af: <a href="https://images.weserv.nl/docs/format.html#adaptive-filter" target="_blank" rel="noopener noreferrer">Adaptative Filter</a> (only works on <em>png</em>)</li><li>l: <a href="https://images.weserv.nl/docs/format.html#compression-level" target="_blank" rel="noopener noreferrer">Compression Level</a> (number between 0 and 9. Only works on <em>png</em>, default 6)</li><li>q: <a href="https://images.weserv.nl/docs/format.html#quality" target="_blank" rel="noopener noreferrer">Quality</a> (only works on <em>jpg</em>, <em>tiff</em> and <em>webp</em>. number between 0 and 100, default 80)</li><li>il: <a href="https://images.weserv.nl/docs/format.html#interlace-progressive" target="_blank" rel="noopener noreferrer">Interlaced/Progressive</a></li></ul><table><thead><tr><th>dpr=2 w=200 l=0</th><th>dpr=2 w=200 l=6 af</th><th>dpr=2 w=200 q=100</th><th>dpr=2 w=200 q=5 il</th></tr></thead><tbody><tr><td>png 481kB</td><td>png 102kB</td><td>jpg 148kB</td><td>jpg 3.8kB</td></tr><tr><td><img src="https://img.ctohm.com/dpr=2_w=200_png_l=0/riff.one/images/dice.png" alt="original"></td><td><img src="https://img.ctohm.com/dpr=2_w=200_png_l=6_af/riff.one/images/dice.png" alt="jpg"></td><td><img src="https://img.ctohm.com/dpr=2_w=200_jpg_q=100/riff.one/images/designcue-unsplash.jpg" alt="af"></td><td><img src="https://img.ctohm.com/dpr=2_w=200_jpg_q=5/riff.one/images/designcue-unsplash.jpg" alt="webp"></td></tr></tbody></table><h3 id="output-format-and-naming" tabindex="-1">Output Format and naming <a class="header-anchor" href="#output-format-and-naming" aria-hidden="true">#</a></h3><ul><li>output: <a href="https://images.weserv.nl/docs/format.html#output" target="_blank" rel="noopener noreferrer">Output</a></li><li>filename: <a href="https://images.weserv.nl/docs/format.html#filename" target="_blank" rel="noopener noreferrer">Filename</a></li></ul><div class="language-html"><pre><code>https://img.ctohm.com/w=150_output=gif/riff.one/images/designcue-unsplash.jpg
</code></pre></div><table><thead><tr><th>Original (png)</th><th>JPEG</th><th>GIF</th><th>WEBP</th></tr></thead><tbody><tr><td><img src="https://img.ctohm.com/w=150_png/riff.one/images/designcue-unsplash.jpg" alt="original"></td><td><img src="https://img.ctohm.com/hue=90_w=150_jpg/riff.one/images/designcue-unsplash.jpg" alt="jpg"></td><td><img src="https://img.ctohm.com/hue=180_w=150_gif/riff.one/images/designcue-unsplash.jpg" alt="gif"></td><td><img src="https://img.ctohm.com/hue=270_w=150_output=webp/riff.one/images/designcue-unsplash.jpg" alt="webp"></td></tr></tbody></table><h3 id="crop" tabindex="-1">Crop <a class="header-anchor" href="#crop" aria-hidden="true">#</a></h3><p><a href="https://images.weserv.nl/docs/crop.html#rectangle-crop" target="_blank" rel="noopener noreferrer">Cropping</a> is achieved through 4 parameters</p><ul><li>cw: &#39;Crop width&#39;,</li><li>cy: &#39;Crop y&#39;,</li><li>cx: &#39;Crop x&#39;,</li><li>ch: &#39;Crop height&#39;,</li></ul><p>This one is tricky to get it right, but you can see an example on the story of <a href="./use_cases.html">my use case</a>.</p><table><thead><tr><th>original w=200 h=150</th><th>w=200 h=150</th><th>w=200 h=150</th><th>w=400 h=300</th></tr></thead><tbody><tr><td></td><td>cx=20 cy=20 fit=cover</td><td>cx=20 cy=20 ch=54 fit=cover</td><td>cx=82 cy=67 ch=137 cw=224 fit=cover</td></tr><tr><td><img src="https://img.ctohm.com/w=200_h=150/riff.one/images/printable_chart.png" alt="original"></td><td><img src="https://img.ctohm.com/w=200_h=150_cx=20_cy=20_fit=cover/riff.one/images/printable_chart.png" alt="jpg"></td><td><img src="https://img.ctohm.com/w=200_h=150_cx=20_cy=20_ch=54_fit=cover/riff.one/images/printable_chart.png" alt="af"></td><td><img src="https://img.ctohm.com/w=400_h=300_cx=82_cy=67_ch=137_cw=224_fit=cover/riff.one/images/printable_chart.png" alt="webp"></td></tr></tbody></table><hr><h2 id="todo" tabindex="-1">TODO <a class="header-anchor" href="#todo" aria-hidden="true">#</a></h2><ul><li>[x] basic tests</li><li>[ ] more tests</li><li>[ ] deploy with workers</li><li>[ ] enable using Edge-Resizer as a dependency</li><li>[x] fix a handful of embarassing bugs after announcing what-i-built</li><li>[ ] use vary to deliver WEBP, then AVIF to everyone except iOS</li><li>[ ] figure out a way to receive device pixel ratio and deliver retina images</li><li>[ ] other transformations</li><li>[ ] get absorbed by Cloudflare</li><li>[ ] don&#39;t get absorbed but have massive adoption <ul><li>[ ] lots of issues</li><li>[x] anxiety</li><li>[ ] abandon project</li></ul></li></ul></div></div><footer class="page-footer" data-v-7eddb2c4 data-v-fb8d84c6><div class="edit" data-v-fb8d84c6><div class="edit-link" data-v-fb8d84c6 data-v-1ed99556><!----></div></div><div class="updated" data-v-fb8d84c6><!----></div></footer><!----><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"about.md\":\"90669054\",\"caching.md\":\"babb1cc6\",\"conversion.md\":\"a9dd83f0\",\"deploy.md\":\"1fda1858\",\"hotlinking.md\":\"2b5b5b68\",\"index.md\":\"6693ebc7\",\"library.md\":\"0b18667a\",\"routing.md\":\"f6c67b58\",\"transformations.md\":\"7ec57a01\",\"use_cases.md\":\"04f5f678\"}")</script>
    <script type="module" async src="/assets/app.9b700571.js"></script>
    
  </body>
</html>